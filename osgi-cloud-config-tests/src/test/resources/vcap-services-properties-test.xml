<?xml version="1.0" encoding="UTF-8"?>
<!--
First, start Karaf with some additional VCAP environment variables:
VCAP_APPLICATION="{}" VCAP_SERVICES='{ "cleardb": [ { "credentials": { "hostname": "us-cdbr-iron-east-03.cleardb.net", "jdbcUrl": "jdbc:mysql://us-cdbr-iron-east-03.cleardb.net/ad_b9eb3f3f82ef228?user=b69bed0a151d22\u0026password=3a5ac732", "name": "ad_b9eb3f3f82ef228", "password": "3a5ac732", "port": "3306", "uri": "mysql://b69bed0a151d22:3a5ac732@us-cdbr-iron-east-03.cleardb.net:3306/ad_b9eb3f3f82ef228?reconnect=true", "username": "b69bed0a151d22" }, "label": "cleardb", "name": "test-mysql", "plan": "spark", "provider": null, "syslog_drain_url": null, "tags": [ "Cloud Databases", "Data Stores", "Web-based", "Online Backup \u0026 Storage", "Single Sign-On", "Cloud Security and Monitoring", "Certified Applications", "Developer Tools", "Data Store", "Development and Test Tools", "Buyable", "relational", "mysql" ], "volume_mounts": [] } ] }' bin/karaf

Then install the MySQL driver using:
> install -s mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.stax-api-1.0/1.9.0
> install -s mvn:mysql/mysql-connector-java/5.1.18

Then copy this file to the deploy folder
-->
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
           xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0">

    <cm:property-placeholder persistent-id="vcap.services" update-strategy="reload">
        <cm:default-properties>
            <cm:property name="mysql.jdbcUrl" value="defaultJdbc"/>
            <cm:property name="mysql.username" value="defaultUsername"/>
            <cm:property name="mysql.password" value="defaultPassword"/>
        </cm:default-properties>
    </cm:property-placeholder>

    <bean id="vcap" class="com.snowfort.osgi.cloud.vcap.VcapServicesProperties" />

    <camelContext xmlns="http://camel.apache.org/schema/blueprint">
        <route>
            <from uri="timer:test" />
            <log message="vcap.services.mysql.jdbcUrl:    ${mysql.jdbcUrl}" loggingLevel="INFO"/>
            <log message="vcap.services.mysql.username:   ${mysql.username}" loggingLevel="INFO"/>
            <log message="vcap.services.mysql.password:   ${mysql.password}" loggingLevel="INFO"/>
        </route>
    </camelContext>

</blueprint>
